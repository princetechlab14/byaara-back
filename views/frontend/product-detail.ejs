<!DOCTYPE html>
<html lang="en">

<head>
    <%- include("./partial/head") %>
</head>

<body class="min-h-screen flex flex-col">
    <%- include("./partial/header") %>
        <main class="flex-grow">
            <div class="my-3">
                <div class="container mx-auto px-4 py-8">
                    <div class="flex flex-wrap -mx-4">
                        <!-- Product Images -->
                        <div class="w-full md:w-1/2 px-4 ">
                            <img src="<%= product.main_image %>" alt="Product"
                                class="w-full h-100 rounded-lg shadow-md mb-4" id="mainImage">
                            <div class="flex gap-4 py-4 justify-center overflow-x-auto">
                                <img src="<%= product.main_image %>"
                                    class="size-16 sm:size-20 object-cover rounded-md cursor-pointer opacity-60 hover:opacity-100 transition duration-300"
                                    onclick="changeImage(this.src)">
                                <% if (product.images && product.images.length) { %>
                                    <% product.images.slice(0, 4).forEach(function(img) { %>
                                        <img src="<%= img %>" alt="Thumbnail"
                                            class="size-16 sm:size-20 object-cover rounded-md cursor-pointer opacity-60 hover:opacity-100 transition duration-300"
                                            onclick="changeImage(this.src)">
                                        <% }); %>
                                            <% } %>
                            </div>
                        </div>

                        <!-- Product Details -->
                        <div class="w-full md:w-1/2 px-4">
                            <h2 class="text-3xl font-bold mb-2">
                                <%= product.title %>
                            </h2>
                            <p class="text-gray-600 mb-4">SKU: <%= product.sku %>
                            </p>
                            <div class="mb-4">
                                <span class="text-gray-500 line-through">RS. <%= product.regular_price %></span>
                                <span class="text-2xl font-bold mx-2">RS. <%= product.sale_price %></span>
                            </div>
                            <div class="flex items-center mb-4">
                                <% let fullStars=Math.floor(product.rating); let halfStar=product.rating % 1>= 0.5;
                                    let emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
                                    %>

                                    <!-- Full Stars -->
                                    <% for (let i=0; i < fullStars; i++) { %>
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                                            class="size-6 text-yellow-500">
                                            <path fill-rule="evenodd"
                                                d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z"
                                                clip-rule="evenodd" />
                                        </svg>
                                        <% } %>

                                            <!-- Half Star -->
                                            <% if (halfStar) { %>
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                                                    fill="currentColor" class="size-6 text-yellow-500">
                                                    <defs>
                                                        <linearGradient id="half-grad">
                                                            <stop offset="50%" stop-color="currentColor" />
                                                            <stop offset="50%" stop-color="transparent"
                                                                stop-opacity="1" />
                                                        </linearGradient>
                                                    </defs>
                                                    <path fill="url(#half-grad)" fill-rule="evenodd"
                                                        d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z"
                                                        clip-rule="evenodd" />
                                                </svg>
                                                <% } %>

                                                    <!-- Empty Stars -->
                                                    <% for (let i=0; i < emptyStars; i++) { %>
                                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none"
                                                            viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"
                                                            class="size-6 text-yellow-500">
                                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                                d="M11.48 3.499a.75.75 0 0 1 1.04 0l2.202 2.2 3.122-.453a.75.75 0 0 1 .832.822l-.452 3.121 2.2 2.203a.75.75 0 0 1 0 1.04l-2.2 2.202.452 3.121a.75.75 0 0 1-.822.832l-3.121-.452-2.202 2.2a.75.75 0 0 1-1.04 0l-2.203-2.2-3.121.452a.75.75 0 0 1-.832-.822l.453-3.121-2.2-2.202a.75.75 0 0 1 0-1.04l2.2-2.203-.453-3.121a.75.75 0 0 1 .822-.832l3.122.453 2.203-2.2z" />
                                                        </svg>
                                                        <% } %>

                                                            <span class="ml-2 text-gray-600">
                                                                <%= product.rating %> (<%= product.review %> reviews)
                                                            </span>
                            </div>

                            <div class="text-gray-600 md:my-3 my-1 text-sm">
                                Taxes included. <a href="#" class="underline">Shipping</a> calculated at checkout.
                            </div>

                            <!-- Pack Options -->
                            <div class="md:my-3 my-1">
                                <span class="text-lg text-gray-400 font-semibold mb-2">Net Quantity</span>
                                <div class="mt-2 flex space-x-3">
                                    <button
                                        class="pack-btn text-md border border-gray-400 bg-black text-white px-4 py-2 rounded-3xl cursor-pointer"
                                        onclick="setQuantity(1, this)">Pack Of 1</button>

                                    <button
                                        class="pack-btn text-md border border-gray-400 bg-transparent text-gray-700 hover:bg-gray-900 hover:text-white px-4 py-2 rounded-3xl cursor-pointer"
                                        onclick="setQuantity(2, this)">Pack Of 2</button>
                                </div>
                            </div>

                            <!-- Quantity Selector -->
                            <div class="md:my-3 my-1">
                                <span class="text-lg text-gray-400 font-semibold mb-2">Quantity (1 in cart)</span>
                                <div
                                    class="mt-2 flex justify-between md:justify-start md:space-x-3 border md:w-32 w-full">
                                    <button class="p-2 rounded-l text-xl decrement cursor-pointer">-</button>
                                    <input type="number" value="1" min="1"
                                        class="w-12 text-center outline-none quantity" />
                                    <button class="p-2 rounded-r text-xl increment cursor-pointer">+</button>
                                </div>
                            </div>

                            <!-- Trigger Button -->
                            <div class="relative inline-flex items-center group md:my-4 my-2 space-x-4 ">
                                <div
                                    class="absolute inset-0 opacity-60 transition-all duration-1000 rounded-xl filter group-hover:opacity-100 group-hover:duration-200">
                                </div>
                                <button
                                    class="group relative flex items-center text-left text-base rounded-xl bg-orange-500 md:px-8 md:py-4 px-3 py-1 font-semibold text-white transition-all duration-200 hover:bg-orange-500 hover:-translate-y-0.5 border-4 border-black cursor-pointer"
                                    onclick="buyNow({
                                        id: '<%= product.id %>',
                                        title: '<%= product.title %>',
                                        price: '<%= product.sale_price %>',
                                        image: '<%= product.main_image %>',
                                        quantity: document.querySelector('.quantity')?.value || 1
                                    })">
                                    <svg class="w-8 h-8 mr-4 flex-shrink-0" fill="none" stroke="currentColor"
                                        stroke-width="2" viewBox="0 0 24 24">
                                        <path
                                            d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.4 5M17 13l2.4 5M6 21a1 1 0 100-2 1 1 0 000 2zm12 0a1 1 0 100-2 1 1 0 000 2z">
                                        </path>
                                    </svg>
                                    <span class="flex flex-col">
                                        <span>Buy Now - Cash on Delivery</span>
                                        <span class="text-sm opacity-80">
                                            Only A Few Left - Don't Miss Out
                                        </span>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="product__description rte quick-add-hidden px-4 py-6 space-y-6 text-gray-700">
                        <%- product.desc %>
                    </div>
                </div>

            </div>
        </main>
        <%- include("./partial/footer") %>
</body>

</html>